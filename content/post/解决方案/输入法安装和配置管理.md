+++
title = "trime,emacs-rimeå’Œsquirrelè¾“å…¥æ³•å’Œé…ç½®ç®¡ç†"
description = "åšæŒä¸ƒä¹ ï¼Œç£¨ç»ƒäººç”Ÿ."
date = 2021-06-22T00:00:00+08:00
publishDate = 2021-06-22T00:00:00+08:00
lastmod = 2021-08-26T19:28:50+08:00
tags = ["ç®¡ç†è€…"]
categories = ["è§£å†³æ–¹æ¡ˆ"]
draft = false
authors = ["iTBoyer"]
+++

## rime {#rime}

rime æ˜¯ä¸€æ¬¾è¾“å…¥å¼•æ“ï¼Œå®ƒå¼€æ”¾äº†ä¸€å¥—é…ç½®åè®®ï¼Œä¸ºå¤šå…ƒçš„è¾“å…¥æ³•ï¼ˆåŒæ–‡è¾“å…¥æ³•ã€é¼ é¡»ç®¡è¾“å…¥æ³•ç­‰ï¼‰çš„åŸºç¡€ï¼Œè¾“å…¥æ³•å’Œrimeå¼•æ“ä¹‹é—´é€šè¿‡è¿™å¥—åè®®å®ç°å¤šæ ·åŒ–çš„è¾“å…¥æ–¹æ¡ˆã€‚  

å®˜æ–¹è§£é‡Šï¼šrimeæ˜¯å•¥ï¼Ÿ > Rime ä¸æ˜¯ä¸€ç§è¾“å…¥æ³•ã€‚æ˜¯ä»å„ç§å¸¸è§é”®ç›˜è¾“å…¥æ³•ä¸­æç‚¼å‡ºæ¥çš„æŠ½è±¡çš„è¾“å…¥ç®—æ³•æ¡†æ¶ã€‚å› ä¸ºRime æ¶µç›–äº†å¤§å¤šæ•°è¾“å…¥æ³•çš„ã€Œå…±æ€§ã€ï¼Œæ‰€ä»¥åœ¨ä¸åŒçš„è®¾å®šä¸‹ï¼ŒRime å¯åŒ–èº«ä¸ºä¸åŒçš„è¾“å…¥æ³•ç”¨æ¥æ‰“å­—ã€‚  

[ä¸‹è¼‰åŠå®‰è£ | RIME | ä¸­å·éŸ»è¼¸å…¥æ³•å¼•æ“](https://rime.im/download/)  


## è¾“å…¥æ–¹æ¡ˆ {#è¾“å…¥æ–¹æ¡ˆ}

rimeæ˜¯ä¸€æ¬¾å¼€æºçš„è¾“å…¥æ³•å¼•æ“ï¼Œçº¦å®šäº†é…ç½®è§„èŒƒï¼Œæ ¹æ®è¿™å¥—è§„èŒƒå¯ä»¥å®šåˆ¶è‡ªå·±çš„ `è¾“å…¥æ–¹æ¡ˆ` ï¼Œç”±æ­¤ï¼Œåº”è¿è€Œç”Ÿé…ç½®ç®¡ç†å·¥å…· [æ±é¢¨ç ´ _plum_](https://hub.fastgit.org/rime/plum#packages) ç»´æŠ¤ç€å¤§é‡ä¼˜ç§€çš„ `è¾“å…¥æ–¹æ¡ˆ` ã€‚  

å®˜æ–¹è§£é‡Šï¼š >è¦è®©Rime å®ç°æŸç§å…·ä½“è¾“å…¥æ³•çš„åŠŸèƒ½ï¼Œå°±éœ€è¦ä¸€äº›æ•°æ®æ¥æè¿°è¿™ç§è¾“å…¥æ³•ä»¥ä½•ç§å½¢å¼å·¥ä½œã€‚å³ï¼Œå®šä¹‰è¯¥è¾“å…¥æ³•çš„ã€Œä¸ªæ€§ã€ã€‚ >å¦‚ã€Œæ±‰è¯­æ‹¼éŸ³ã€ã€ã€Œæ³¨éŸ³ã€ã€ã€Œä»“é¢‰ç ã€ã€ã€Œäº”ç¬”å­—å‹ã€ï¼Œè¿™äº›æ–¹æ³•å¯å‡­å€ŸRime æä¾›çš„é€šç”¨è®¾æ–½ã€ç»™å®šä¸åŒçš„å·¥ä½œå‚æ•°æ¥å®ä½œã€‚ä»¥æœ¬æ–‡ä»‹ç»çš„è§„æ ¼å†™æˆä¸€å¥—å¥—çš„é…æ–¹ï¼Œå°±æ˜¯Rime è¾“å…¥æ–¹æ¡ˆã€‚  

å¸¸ç”¨çš„è¾“å…¥æ–¹æ¡ˆï¼š[rime-luna-pinyin: ã€æœ™æœˆæ‹¼éŸ³ã€‘è¼¸å…¥æ–¹æ¡ˆ](https://github.com/rime/rime-luna-pinyin)  

å¦‚æœæƒ³å®šåˆ¶é”®ä½/å¿«æ·é”®å¯ä»¥å‚è€ƒï¼š [CustomizationGuide Â· rime/home Wiki Â· GitHub](https://hub.fastgit.org/rime/home/wiki/CustomizationGuide)  

åˆ›å»ºè‡ªå·±çš„ `è¾“å…¥æ–¹æ¡ˆ` ï¼š[RimeWithSchemata Â· rime/home Wiki Â· GitHub](https://hub.fastgit.org/rime/home/wiki/RimeWithSchemata)  


## å®‰å“ç‰ˆ:trime {#å®‰å“ç‰ˆ-trime}

è¯¦ç»†çš„æ–‡æ¡£ ï¼š[trime.yamlè©³è§£ ](https://github.com/osfans/trime/wiki/trime.yaml%E8%A9%B3%E8%A7%A3)  

{{< figure src="/ox-hugo/trime.png" >}}  


### trimeè¾“å…¥æ–¹æ¡ˆ {#trimeè¾“å…¥æ–¹æ¡ˆ}

ä½¿ç”¨è¾“å…¥æ³•é…ç½®åº“ï¼š[rimerc](https://hub.fastgit.org/Bambooin/rimerc), å¤§ç‰›é…ç½®å¥½çš„é…ç½®ï¼ŒåŒ…æ‹¬åŒæ–‡å’Œsquirrel é…ç½®ã€‚  

é…ç½®è·¯å¾„åœ¨`/sdcard/rime`, å°†`rimerc` åº“ä¸­çš„trime.z7 è§£å‹åˆ°è¯¥ç›®å½•ã€‚  

>rimerc åº“å†…å®¹å·²ç»å˜åŒ–ï¼Œä½œè€…è¿˜æ²¡æœ‰æ›´æ–°readme.  


#### å®šåˆ¶å€™é€‰è¯æ¡çš„ä¸ªæ•° {#å®šåˆ¶å€™é€‰è¯æ¡çš„ä¸ªæ•°}

åœ¨ `default.custom.yaml` æ–‡ä»¶ä¸­æ·»åŠ   

{{< highlight yaml "linenos=table, linenostart=1, hl_lines=0-0 0-0" >}}
  patch:
    menu/page_size: 10
{{< /highlight >}}


#### éšè—ä¾¯é€‰æ¡†çš„æ–¹æ³• {#éšè—ä¾¯é€‰æ¡†çš„æ–¹æ³•}

åœ¨ `luna_pinyin.schema.yaml` å®šåˆ¶ï¼š  

{{< highlight yaml "linenos=table, linenostart=1, hl_lines=0-0 0-0" >}}
  - name: _hide_candidate
   reset: 0  #é»˜è®¤å¼€å¯è¿™ä¸ªå¼€å…³ï¼Œéšè—å€™é€‰æ 
{{< /highlight >}}


#### è®¾ç½®è¾“å…¥æ³•åå¥½ {#è®¾ç½®è¾“å…¥æ³•åå¥½}

-   [X] æ±‰å­—ä¸å°å†™åŠè§’
-   [X] æ±‰å­—ä¸ä¸­æ–‡æ ‡ç‚¹é…å¥—
-   [X] è‹±æ–‡ä¸è‹±æ–‡æ ‡ç‚¹

åœ¨ `luna_pinyin.schema.yaml` å®šåˆ¶ï¼š  

{{< highlight yaml "linenos=table, linenostart=1, hl_lines=0-0 0-0" >}}
switches:
  - name: ascii_mode
    reset: 1
    states: [ ä¸­æ–‡, è¥¿æ–‡ ]
  - name: full_shape
    states: [ åŠè§’, å…¨è§’ ]
  - name: simplification
    reset: 1
    states: [ æ¼¢å­—, æ±‰å­— ]
  - name: ascii_punct
    reset: 0
    states: [ ã€‚ï¼Œ, ï¼ï¼Œ ]
#  - name: _hide_candidate
 #   reset: 0  #é»˜è®¤å¼€å¯è¿™ä¸ªå¼€å…³ï¼Œéšè—å€™é€‰æ 
      # è¿™ä¸ªæŒ‰é”®ç”¨æ¥æ”¶èµ·è½¯é”®ç›˜
#  - options: [ _key_Control_L ]
#    states: [ "CTRL" ]
#  - options: [ _key_Escape ]
#    states: [ "ESC" ]
#  - options: [ _key_Alt_L ]
#    states: [ "Alt" ]
{{< /highlight >}}


#### é”®ä½è®¾ç½® {#é”®ä½è®¾ç½®}

trime é”®ä½åˆ†ä¸ºä¸¤ç§ï¼Œ26é”®å’Œ36é”®  

trimeé»˜è®¤26é”®ä½,ç»‘å®šé”®ä½çš„æ–¹æ³•ï¼š `querty`  

{{< highlight yaml "linenos=table, linenostart=1, hl_lines=0-0 0-0" >}}
 "preset_keyboards/qwerty/keys/@26/click": date_time
{{< /highlight >}}

å¼€å¯36é”®ä½çš„æ–¹æ³•ï¼š `querty0`  

{{< highlight yaml "linenos=table, linenostart=1, hl_lines=0-0 0-0" >}}
   "preset_keyboards/luna_pinyin/import_preset": qwerty0
   "preset_keyboards/qwerty0/keys/@43/long_click": Mode_switch
{{< /highlight >}}

é”®ä½ç»‘å®šæ”¯æŒä¸¤ç§æ–¹å¼ï¼šé”®ä½å ç”¨å’Œé”®ä½é•¿æŒ‰  

{{< highlight yaml "linenos=table, linenostart=1, hl_lines=0-0 0-0" >}}
# clickç»‘å®šé”®ä½
 "preset_keyboards/qwerty/keys/@26/click": date_time
# long_clickç»‘å®šé”®ä½é•¿æŒ‰
 "preset_keyboards/qwerty/keys/@26/long_click": date_time
{{< /highlight >}}

<!--list-separator-->

-  å£°æ˜é”®äº‹ä»¶å¹¶ç»‘å®š

    1.  å£°æ˜æ–¹å¼ä½¿ç”¨ `"preset_keys/custom_key":`  
        
        {{< highlight yaml "linenos=table, linenostart=1, hl_lines=0-0 0-0" >}}
           # å‚è€ƒtrime.yamlå†…ç½®çš„dateé”®ï¼Œæ–°å»ºä¸€ä¸ªæŒ‰é”®date_time
             "preset_keys/date_time":
               command: date
               label: æ—¶é—´
               option: "yyyy-MM-dd  HH:mm:ss"  #é€šè¿‡`option`å‚æ•°æ§åˆ¶è¾“å‡ºçš„æ—¥æœŸå’Œæ—¶é—´æ ¼å¼
               send: function
        
            #Clear: {label: æ¸…é™¤, text: "{Control+a}{BackSpace}"} #å…¨é¸ä¸¦åˆªé™¤
             "preset_keys/cg":
               label: æ’¤é”€
               send: Control+g
             "preset_keys/cc":
               label: å®Œ1
               text: "{Control+c}{Control+c}"
             "preset_keys/control":
               label: CTR
               send: Control_L #space+colon
        {{< /highlight >}}
    2.  ç”¨data\_timeæ›¿æ¢åŸé¢„è®¾26é”®é”®ç›˜ä¸­çš„time  
        
        {{< highlight yaml "linenos=table, linenostart=1, hl_lines=0-0 0-0" >}}
             "preset_keyboards/qwerty/keys/@26/long_click": date_time
             "preset_keyboards/qwerty/keys/@33/long_click": Mode_switch
             "preset_keyboards/qwerty/keys/@36/long_click": todo
        {{< /highlight >}}
    3.  è®©æœ™æœˆæ‹¼éŸ³ä½¿ç”¨36é”®é”®ç›˜å¸ƒå±€  
        
        {{< highlight yaml "linenos=table, linenostart=1, hl_lines=0-0 0-0" >}}
              "preset_keyboards/luna_pinyin/import_preset": qwerty0
              "preset_keyboards/qwerty0/keys/@36/long_click": date_time
              "preset_keyboards/qwerty0/keys/@43/long_click": Mode_switch
              "preset_keyboards/qwerty0/keys/@46/long_click": todo
        {{< /highlight >}}


#### å®šåˆ¶é•¿æŒ‰ç©ºæ ¼é”®åˆ‡æ¢ä¸­è‹±æ–‡ {#å®šåˆ¶é•¿æŒ‰ç©ºæ ¼é”®åˆ‡æ¢ä¸­è‹±æ–‡}

åœ¨ `trime.custom.yaml` ä¸­å®šåˆ¶å¦‚ä¸‹æ“ä½œï¼š `Mode_switch` æ˜¯åˆ‡æ¢ä¸­è‹±æ–‡äº‹ä»¶ï¼ŒåŒºåˆ†å¤§å°å†™ã€‚ç»‘å®šåˆ°ç©ºæ ¼çš„é”®ä½ `@33` ä¸Šã€‚  

{{< highlight yaml "linenos=table, linenostart=1, hl_lines=0-0 0-0" >}}
    "preset_keyboards/qwerty/keys/@33/long_click": Mode_switch
{{< /highlight >}}


#### å®šåˆ¶é•¿æŒ‰Enteré”®è¾“å…¥ ~ - [ ] ~ {#å®šåˆ¶é•¿æŒ‰enteré”®è¾“å…¥}

åœ¨ `trime.custom.yaml` ä¸­å®šåˆ¶å¦‚ä¸‹æ“ä½œï¼šå£°æ˜è¾“å…¥çš„æ–‡æœ¬  

{{< highlight yaml "linenos=table, linenostart=1, hl_lines=0-0 0-0" >}}
  "preset_keys/todo":
    label: "- [ ]"
    text: "- [ ] "
{{< /highlight >}}

æ·»åŠ åˆ°é•¿æŒ‰äº‹ä»¶ä¸­  

{{< highlight yaml "linenos=table, linenostart=1, hl_lines=0-0 0-0" >}}
    "preset_keyboards/qwerty/keys/@36/long_click": todo
{{< /highlight >}}


#### çŠ¶æ€æ æ·»åŠ èœå•é¡¹ {#çŠ¶æ€æ æ·»åŠ èœå•é¡¹}

[trime.yamlè©³è§£ Â·switches](https://github.com/osfans/trime/wiki/trime.yaml%E8%A9%B3%E8%A7%A3#2switches) åœ¨çŠ¶æ€æ ä¸Šæ·»åŠ æŒ‰é”®ï¼š  

ç¤ºä¾‹ï¼š åœ¨çŠ¶æ€æ æ”¾ç½®æŒ‰é”®ï¼ˆè¯•éªŒåŠŸèƒ½ï¼‰ `option` æ ¼å¼ï¼š  

1.  `_key_` + `æŒ‰é”®` ï¼ˆè¿™é‡Œçš„æŒ‰é”®å¯ä»¥æ˜¯åŠŸèƒ½é”®ã€ç¬¦å·ã€å­—æ¯ã€ä»»æ„æ–‡æœ¬ï¼‰
2.  `_keyboard_` + `é”®ç›˜å¸ƒå±€ID` ï¼ˆä¸€äº›æ¯”è¾ƒç‰¹æ®Šçš„idï¼š.defaultè¿”å›å½“å‰ä¸»é”®ç›˜ï¼Œ.nextä¸‹ä¸€ä¸ªé”®ç›˜ï¼Œ.laståœ¨æœ€è¿‘ä½¿ç”¨çš„ä¸¤ä¸ªé”®ç›˜é—´è½®æ¢ï¼Œ.last\_lockè¿”å›ä¸Šä¸€ä¸ªæ ‡è®°ä¸ºlockçš„é”®ç›˜ï¼‰

éœ€è¦åœ¨æ–¹æ¡ˆæ–‡ä»¶çš„ `xx.custom.yaml` ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š  

{{< highlight yaml "linenos=table, linenostart=1, hl_lines=0-0 0-0" >}}
switches:
  # è¿™ä¸ªæŒ‰é”®ç”¨æ¥æ”¶èµ·è½¯é”®ç›˜
  - options: [ _key_Hide ]
    states: [ "â–¼" ]
  #statesæ˜¯æ˜¾ç¤ºåœ¨çŠ¶æ€æ çš„å›¾æ ‡ï¼Œoptionsæ˜¯å®é™…æ‰§è¡Œçš„åŠŸèƒ½

  # è¿™ä¸ªæŒ‰é”®ç”¨æ¥è°ƒå‡ºè¾“å…¥æ³•åˆ‡æ¢èœå•
  - options: [ _key_IME_switch ]
    states: [ "ğŸŒ" ]
  # æ›´å¤šåŠŸèƒ½é”®è¯·æŸ¥é˜…trime.yaml/preset_keys

  # è¿™æ˜¯ä¸€ä¸ªç©ºæŒ‰é”®ï¼ŒæŒ‰ä¸‹å»ä¸ä¼šæ‰§è¡Œä»»ä½•åŠ¨ä½œ
  - options: [ _key_VoidSymbol ]
    states: [ "    " ] #ç©ºé”®çš„å®½åº¦ç”±è¿™é‡Œçš„ç©ºæ ¼å†³å®š

  # è¿™ä¸ªæŒ‰é”®ç”¨æ¥è¾“å‡ºå¥å·
  - options: [ _key_period ] #periodæ˜¯å¥å·çš„è‹±æ–‡åï¼Œä¹Ÿå¯ä»¥ç›´æ¥å†™æˆ[ _key_. ]
    states: [ "ã€‚" ]
{{< /highlight >}}


## squirrel {#squirrel}

ç½‘ä¸Šæ•™ç¨‹å¾ˆå¤šï¼Œè¾“å…¥æ³•ç›®å½•åœ¨`~/Library/Rime` ä¸‹ï¼Œå¯ä»¥å€ŸåŠ©`plum` å·¥å…·å®‰è£…. æœ¬äººä½¿ç”¨`rimerc` åº“ä¸­çš„é…ç½®ï¼Œclone ä¹‹åï¼Œè§£å‹å®‰è£…åˆ°Rime ç›®å½•å³å¯. è®¾ç½®å¤šå°è®¾å¤‡åŒæ­¥ï¼šsync\_dir: "_Users/boyer/ResilioSync/RimeSync/squirrel_"  


## emacs-rime {#emacs-rime}


### å®‰è£… librime {#å®‰è£…-librime}

1.  å…ˆå®‰è£…é¼ é¡»ç®¡ï¼Œé‡Œé¢æœ‰è¾“å…¥æ³•æ–¹æ¡ˆã€‚
2.  ç„¶åç›´æ¥ä¸‹è½½ç¼–è¯‘å¥½çš„ `librime` çš„ [Releases](https://github.com/rime/librime/releases/) ç‰ˆæœ¬ã€‚  
    
    {{< highlight sh "linenos=table, linenostart=1, hl_lines=0-0 0-0" >}}
       curl -L -O https://github.com/rime/librime/releases/download/1.7.1/rime-1.7.1-osx.zip
       unzip rime-1.7.1-osx.zip -d ~/.emacs.d/librime
       rm -rf rime-1.7.1-osx.zip
    {{< /highlight >}}


### emacs é…ç½® {#emacs-é…ç½®}

åœ¨ doom ä¸‹å®‰è£…  

{{< highlight elisp "linenos=table, linenostart=1, hl_lines=0-0 0-0" >}}
(package! rime)
{{< /highlight >}}

åå¥½è®¾ç½®ï¼š `rime-librime-root` : æŒ‡å®šä¸ºå®‰è£… `librime` çš„ç›®å½• `~/.emacs.d/librime/dist`  

{{< highlight elisp "linenos=table, linenostart=1, hl_lines=5-5 0-0" >}}
(use-package! rime
  :custom
  (default-input-method "rime")
  (rime-emacs-module-header-root "/Applications/Emacs.app/Contents/Resources/include/")
  (rime-librime-root (expand-file-name "librime/dist" user-emacs-directory))
  (rime-cursor "Ë°")
  (rime-show-candidate 'posframe)
  ;;https://emacs-china.org/t/doom-emacs-rime/12499/18?u=huos3203
;;  (rime-share-data-dir "/Users/boyer/Library/Rime")
;;  (rime-user-data-dir "/Users/boyer/Library/Rime")
  (rime-posframe-properties
   (list :background-color "#073642"
         :foreground-color "#839496"
         :internal-border-width 1
         :font "Input Mono Narrow"
         ))
  ;;
  (rime-disable-predicates '(rime-predicate-evil-mode-p
                             rime-predicate-after-alphabet-char-p
                             rime-predicate-prog-in-code-p))
  ;;; å…·ä½“å‚è€ƒ mode-line-mule-info é»˜è®¤å€¼ï¼Œå…¶ä¸­å¯èƒ½æœ‰å…¶å®ƒæœ‰ç”¨ä¿¡æ¯
  (mode-line-mule-info '((:eval (rime-lighter))))
  ;;åœ¨ minibuffer ä½¿ç”¨åè‡ªåŠ¨å…³é—­è¾“å…¥æ³•
  (rime-deactivate-when-exit-minibuffer t)

  :config
  (set-face-attribute 'rime-default-face nil :foreground "#839496" :background "#073642")
  )
{{< /highlight >}}


### é«˜ä½é…ç½® {#é«˜ä½é…ç½®}

1.  è®¾ç½®é»˜è®¤è¾“å…¥æ³•ï¼š `Mx: rime-open-configuration` æ‰“å¼€æ–‡ä»¶ï¼š `~/L.emacs.d/.local/etc/rime/default.custom.yaml`,ä¸å­˜åœ¨æ—¶ï¼Œæ–°å»ºã€‚

<!--listend-->

{{< highlight yaml "linenos=table, linenostart=1, hl_lines=0-0 0-0" >}}
patch:
  schema_list:  # å°æ–¼åˆ—è¡¨é¡å‹ï¼Œç¾åœ¨ç„¡æœ‰è¾¦æ³•æŒ‡å®šå¦‚ä½•æ·»åŠ ã€æ¶ˆé™¤æˆ–å–®ä¸€ä¿®æ”¹æŸé …ï¼Œæ–¼æ˜¯è¦åœ¨å®šè£½æª”ä¸­å°‡æ•´å€‹åˆ—è¡¨æ›¿æ›ï¼
    - schema: luna_pinyin_simp  #é»˜è®¤ç®€ä½“è¾“å…¥æ³•
{{< /highlight >}}

1.  è®¾ç½®ç”¨æˆ·é…ç½®åŒæ­¥ç›®å½•ä¸èƒ½å’Œ `squirrel` å…±ç”¨åŒæ­¥ç›®å½•ï¼Œä¼šå‡ºç°é…ç½®æ— æ•ˆç­‰å¼‚å¸¸é—®é¢˜ã€‚ `emacs-rime` åŒæ­¥ç›®å½•ï¼š `sync_dir: "/Users/boyer/ResilioSync/RimeSync/emacs-rime/"`

æœ‰å¸®åŠ©çš„èµ„æ–™ï¼šä½œè€…æ€»ç»“ç»å¸¸é—®é¢˜ï¼š[GitHub - DogLooksGood/emacs-rime: RIME ã„“ in Emacs ](https://github.com/DogLooksGood/emacs-rime#faq)
